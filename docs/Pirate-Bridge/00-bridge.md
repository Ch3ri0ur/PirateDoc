# Overview Pirate Bridge

The Bridge components major concern is providing the user with all the resources he/she needs and connecting the user with Arduino. 

## Requirements
In this section an overview of the necessary functions are provided.

* Managing the connection with the Pirate Hook on the connected Arduino
* Serving the API 
    * Sending the project data 
    * Receiving and forwarding control commands
* Serving the client website 
* Enabling access to the client over the internet

## Getting Started

## Implementation

This module has 3 components:

* a component dealing with the serial interface,
* a component providing the http interface
* and a reverse proxy to provide a unified endpoint.

The first two components are written in [[nodejs]]. The components communicate internally by writing into a shared data structure for data to be sent / received. The Hook can send messages "anytime" but the communication in the other direction the Bridge can not. The Pirate Hook needs to poll for return messages.

The used [serialport library](https://serialport.io/) creates a event every time a new message is received. This message is parsed and depending on the [message type](../Pirate-Hook/serial-protocol.md) different handlers are used process the data. 
* On the first startup a set of configuration messages are sent from the Arduino, detailing the meta information about the variables that can be sent to and from the Arduino.
* If data is to be sent to the clients it is placed into a send buffer.
* If a request for data from the Arduino is received, another buffer is checked for outstanding control messages from the clients.

The server providing the interface exposes a set of endpoints. In general when request


The reverse proxy is provided by a server solution called [[caddy]].

## Theory

Fundamental information is provided in the following pages, but keywords are also linked throughout the articles:

- [[nodejs]]
- [[docker]]
- [[raspberrypi]]
- [[caddy]]
- dns
- servers 
- http
- reverse proxy
- events
- containers
- serial interface


## Requirements Fulfillment

## Future Steps

[//begin]: # "Autogenerated link references for markdown compatibility"
[nodejs]: Theory\nodejs "Nodejs"
[caddy]: Theory\caddy "Caddy"
[docker]: Theory\docker "Docker"
[raspberrypi]: Theory\raspberrypi "Raspberry Pi"
[//end]: # "Autogenerated link references"